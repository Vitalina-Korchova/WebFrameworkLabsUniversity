(()=>{"use strict";var e={419:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Library=void 0,t.Library=class{constructor(){this.items=[]}addItem(e){this.items.push(e)}getAllItems(){return this.items}findItem(e){return this.items.find(e)}removeItem(e){this.items=this.items.filter((t=>!e(t)))}clear(){this.items.length=0}}},369:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Modal=void 0,t.Modal=class{static showBorrowModal(e){e.addEventListener("click",(()=>{document.getElementById("modalBorrow").style.display="block";const e=document.getElementById("btn_close_modal");this.closeBorrowModal(e)}))}static closeBorrowModal(e){e.addEventListener("click",(()=>{document.getElementById("modalBorrow").style.display="none"}))}}},524:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.User=t.Book=void 0,t.Book=class{constructor(e,t,o){this.nameBook=e,this.authorBook=t,this.releaseYearBook=o}printInfo(){return`${this.nameBook} by ${this.authorBook} (${this.releaseYearBook})`}},t.User=class{constructor(e,t,o){this.idUrser=e,this.nameUser=t,this.emailUser=o}printInfo(){return`ID: ${this.idUrser},  ${this.nameUser} ${this.emailUser}`}}},154:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.LibraryService=void 0;const r=o(524),a=o(419),s=o(421);t.LibraryService=class{constructor(){this.booksLibrary=new a.Library,this.userLibrary=new a.Library,this.borrowStatus={},this.loadData()}addBook(e){this.booksLibrary.addItem(e),this.saveData()}addUser(e){this.userLibrary.addItem(e),this.saveData()}getAllBooks(){return this.booksLibrary.getAllItems()}getAllUsers(){return this.userLibrary.getAllItems()}findBook(e){return this.booksLibrary.findItem(e)}findUser(e){return this.userLibrary.findItem(e)}borrowBook(e,t){if(this.borrowStatus[e])return!1;const o=this.findBook((t=>t.printInfo().includes(e))),r=this.findUser((e=>e.printInfo().startsWith(t.toString())));return!(!o||!r||(this.borrowStatus[e]=t,this.saveData(),0))}returnBook(e){return!!this.borrowStatus[e]&&(delete this.borrowStatus[e],this.saveData(),!0)}getBorrowedBooks(){return Object.entries(this.borrowStatus).map((([e,t])=>({bookName:e,userId:t})))}saveData(){s.Storage.saveData("books",this.booksLibrary.getAllItems()),s.Storage.saveData("users",this.userLibrary.getAllItems()),s.Storage.saveData("borrowStatus",this.borrowStatus)}loadData(){const e=s.Storage.loadData("books"),t=s.Storage.loadData("users"),o=s.Storage.loadData("borrowStatus");e.forEach((e=>this.booksLibrary.addItem(new r.Book(e.nameBook,e.authorBook,e.releaseYearBook)))),t.forEach((e=>this.userLibrary.addItem(new r.User(e.idUrser,e.nameUser,e.emailUser)))),this.borrowStatus=o}clearBooks(){this.booksLibrary.clear(),this.saveData(),s.Storage.clearData("book_items")}clearUsers(){this.userLibrary.clear(),this.saveData(),s.Storage.clearData("user_items")}}},421:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Storage=void 0,t.Storage=class{static saveData(e,t){localStorage.setItem(e,JSON.stringify(t))}static loadData(e){return JSON.parse(localStorage.getItem(e)||"[]")}static clearData(e){localStorage.removeItem(e)}static saveElementState(e,t){localStorage.setItem(e,t)}static loadElementState(e){return localStorage.getItem(e)||""}}},529:(e,t)=>{function o(e,t){const o=e.value.trim(),r=(new Date).getFullYear(),a=parseInt(o);let s=!0;return""===o?(t.textContent="Введіть рік видання!",e.setCustomValidity("invalid"),s=!1):!/^\d{4}$/.test(o)||isNaN(a)||a<1||a>r?(t.textContent=`Введіть коректний рік видання (від 1 до ${r})`,e.setCustomValidity("invalid"),s=!1):(e.classList.add("was-validated"),t.textContent="",e.setCustomValidity("")),s}Object.defineProperty(t,"__esModule",{value:!0}),t.ValidationBook=function(){const e=document.querySelectorAll(".needs-validation-book");let t=!0;return e.forEach((function(e){if(e instanceof HTMLFormElement){e.checkValidity()||(t=!1);const r=e.querySelector(".input_release_year"),a=e.querySelector(".input_release_year + .invalid-feedback");r&&a&&(r.addEventListener("input",(function(){o(r,a)})),o(r,a)||(t=!1)),e.classList.add("was-validated"),t&&(e.reset(),e.classList.remove("was-validated"))}})),t},t.ValidationUser=function(){const e=document.querySelectorAll(".needs-validation-user");let t=!0;return e.forEach((function(e){if(e instanceof HTMLFormElement){e.checkValidity()||(t=!1);const o=e.querySelector(".input_email"),r=e.querySelector(".input_email + .invalid-feedback"),a=/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/;o&&r&&o.addEventListener("input",(function(){a.test(o.value.trim())?(o.classList.add("was-validated"),r.textContent="",o.setCustomValidity("")):(r.textContent="Введіть правильний email!",o.setCustomValidity("invalid"),t=!1)})),e.classList.add("was-validated"),t&&(e.reset(),e.classList.remove("was-validated"))}})),t}}},t={};function o(r){var a=t[r];if(void 0!==a)return a.exports;var s=t[r]={exports:{}};return e[r](s,s.exports,o),s.exports}(()=>{const e=o(524),t=o(154),r=o(421),a=o(529),s=o(369);class i{constructor(){this.libraryService=new t.LibraryService,console.log(this.libraryService.getAllBooks()),console.log(this.libraryService.getAllUsers()),this.loadDataFromLocalStorage(),this.blockBooks(),this.blockUsers()}loadDataFromLocalStorage(){const e=r.Storage.loadElementState("book_items"),t=document.querySelector(".book_items");t&&e&&(t.innerHTML=e);const o=r.Storage.loadElementState("user_items"),a=document.querySelector(".user_items");a&&o&&(a.innerHTML=o)}blockBooks(){var t,o;null===(t=document.querySelector(".btn_clear_books"))||void 0===t||t.addEventListener("click",(()=>{this.libraryService.clearBooks();const e=document.querySelector(".book_items");e&&(e.innerHTML=""),r.Storage.clearData("book_items")})),null===(o=document.querySelector(".input_add_book"))||void 0===o||o.addEventListener("click",(t=>{var o,i,n;t.preventDefault();const l=document.querySelector(".book_items"),d=null===(o=document.querySelector(".input_name_book"))||void 0===o?void 0:o.value,c=null===(i=document.querySelector(".input_author_book"))||void 0===i?void 0:i.value,u=null===(n=document.querySelector(".input_release_year"))||void 0===n?void 0:n.value;if((0,a.ValidationBook)()){const t=new e.Book(d,c,parseInt(u));this.libraryService.addBook(t);const o=document.createElement("div"),a=document.createElement("div");a.classList.add("d-flex","justify-content-between");const i=document.createElement("span");i.textContent=t.printInfo(),i.classList.add("fs-5");const n=document.createElement("button");n.textContent="Позичити",n.type="button",n.classList.add("btnBorrowOff","btn","btn-primary","btn-sm"),s.Modal.showBorrowModal(n);const m=document.createElement("hr");a.appendChild(i),a.appendChild(n),o.appendChild(a),o.appendChild(m),null==l||l.appendChild(o),r.Storage.saveElementState("book_items",(null==l?void 0:l.innerHTML)||"")}}))}blockUsers(){var t,o;let s=1;null===(t=document.querySelector(".btn_clear_users"))||void 0===t||t.addEventListener("click",(()=>{this.libraryService.clearUsers();const e=document.querySelector(".user_items");e&&(e.innerHTML=""),r.Storage.clearData("user_items")})),null===(o=document.querySelector(".input_add_user"))||void 0===o||o.addEventListener("click",(t=>{var o,i;t.preventDefault();const n=document.querySelector(".user_items"),l=null===(o=document.querySelector(".input_username"))||void 0===o?void 0:o.value,d=null===(i=document.querySelector(".input_email"))||void 0===i?void 0:i.value;if((0,a.ValidationUser)()){const t=s++,o=new e.User(t,l,d);this.libraryService.addUser(o);const a=document.createElement("div"),i=document.createElement("div");i.classList.add("d-flex","justify-content-between");const c=document.createElement("span");c.textContent=o.printInfo(),c.classList.add("fs-5");const u=document.createElement("hr");i.appendChild(c),a.appendChild(i),a.appendChild(u),null==n||n.appendChild(a),r.Storage.saveElementState("user_items",(null==n?void 0:n.innerHTML)||"")}}))}}document.addEventListener("DOMContentLoaded",(()=>{console.log("DOM fully loaded and parsed"),new i}))})()})();